{% extends 'base.html' %}
{% load custom_tags %}


{% load static %}
{% load mathfilters %}

{% block title %} {{request.user.profile.client}}   INSPECTION {{inspection.0.0.0}} {% endblock%}

{% block PageTitle %}{{request.user.profile.client}} || {{warehouseName.0.0.0}} {% endblock %}

{% block PageInfo %}
<div >
    <p>{{warehouseName.0.0.1}},{{warehouseName.0.0.2}},<br>{{warehouseName.0.0.3}}<br>
        Inspection date:{{inspection.0.0.1}} || Description : {{inspection.0.0.0}} </p></div>
{% endblock %}


{% block indicators %}

<div class="row">
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-info">
            <div class="inner">
                <h3>{{warehouseTotalCount}}</h3>

                <p>WMS Ocupation</p>
            </div>
            <div class="icon">
                <i class="ion ion-bag"></i>
            </div>

            <span class="small-box-footer">                <h3>{{readedCount}}</h3>
                  <p>Read Ocupation</p></span>
        </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-success">
            <div class="inner">
                <h3>{{warehouseTotalPositions}}</h3>

                <p>WMS positions</p>
            </div>
            <div class="small-box-footer">
                <h3>{{readedPositions}}</h3>

                <p>Readed positions</p>
            </div>

        </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-warning">
            <div class="inner ">
                <h3>{{warehouseRatio}} %</h3>

                <p>Ocupation Ratio</p>
            </div>
            <div class="small-box-footer ">
                <h3>{{readedRatio}} %</h3>

                <p>Readed Ratio</p>
            </div>


        </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-6">
        <!-- small box -->
        <div class="small-box bg-danger">
            <div class="inner">
                <h3>6<sup style="font-size: 20px">%</sup></h3>

                <p>Missmatch</p>
            </div>
            <div class="icon">
                <i class="ion ion-pie-graph"></i>
            </div>
            <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- ./col -->
</div>
{% endblock %}

{% block content %}

<div class="row">
    <!-- Left col -->
    <section class="col-lg-7 col-md-10 col-sm-10  connectedSortable">
        <!-- Custom tabs (TABLE)-->
        <div class="card">
            <div class="card-header">
                <div class="row">

                    <div class="col-md-10">
                        <div class="row">
                            <div class="col-md-3"><h3 class="card-title text-bold">Position | Unit match</h3></div>
                            <div class="col-md-4">Showing Records: {{request.GET.offset }} {{readedCount|sub:request.GET.qty}}</div>
                            <div class="col-md-5">
                                <nav aria-label="Page navigation example">
                                    <ul class="pagination">
                                        {% if  request.GET.offset > "0" %}
                                        <li class="page-item">
                                            <a class="page-link" href="all?id_inspection={{request.GET.id_inspection}}&qty={{request.GET.qty}}&offset={{request.GET.offset|sub:request.GET.qty}}" aria-label="Previous">
                                                <span aria-hidden="true">&laquo; 500</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                        <li class="page-item"><a class="page-link" href="all?id_inspection={{request.GET.id_inspection}}&qty={{readedCount}}&offset=0">get All Data</a></li>


                                        <li class="page-item">
                                            <a class="page-link" href="all?id_inspection={{request.GET.id_inspection}}&qty={{request.GET.qty}}&offset={{request.GET.qty|add:request.GET.offset}}" aria-label="Next">
                                                <span aria-hidden="true">500 &raquo;</span>
                                            </a>
                                        </li>


                                    </ul>
                                </nav>

                            </div>
                        </div>
                    </div>

                </div>
                <!-- /.card-header -->
                <div class="card-body">



                        <table id="table1" name="example1" class="table table-responsive table-bordered table-striped dataTable dtr-inline" role="grid" aria-describedby="table1_info">
                            <thead>
                            <tr role="row">
                                {% for col in description %}
                                <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">{{col}}</th>
                                {% endfor %}
                            </tr>
                            </thead>
                            <tbody>
                            {% for row in data %}
                            {% with idPic=row.0%}
                            <tr role="row" class="odd">
                                {% for item in row %}
                                <td> {% if forloop.last %}
                                    <div class="text-center">
                                        <a href="media/smarti/{{item}}" ><img src="media/smarti/{{item}}" class="rounded" alt="..." style="width: 200px; height: 200px;"></a>
                                    </div>

                                    <!--                      <a href="media/smarti/{{item}}" >-->
                                    <!--                          <i class="fas fa-camera"></i>-->

                                    <!--                       <img class="img-thumbnail" src="media/smarti/{{item}}" style="" alt="">-->
                                    <!--                        </a>-->
                                    {% else %} {{item}}
                                    {% endif %}


                                </td>

                                {% endfor %}
                                {% endwith %}
                            </tr>
                            {% endfor %}
                            </tbody>
                            <tfoot>
                            <tr role="row">
                                {% for col in description %}
                                <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending">{{col}}</th>
                                {% endfor %}
                            </tr>
                            </tfoot>
                        </table>


                </div>
                <!-- /.card-body -->
            </div>

            <!-- /.card -->
            <!-- /.card -->
    </section>
    <section class="col-lg-5 col-md-2 col-sm-10">
        <div class="col-md-3">
            <form method = "post" action="">
                {% csrf_token %}
                <button type="submit" id="exportData" class="btn btn-block btn-secondary">Export all Data</button>
            </form>
        </div>
    </section>

    <!-- /.Left col -->
    <!-- right col (We are only adding the ID to make the widgets sortable)-->

    <!-- right col -->
</div>

{% endblock %}

{% block pageScripts %}
<script>
  $(document).ready(function() {

    $("#table1").DataTable({
      "responsive": true,
      "autoWidth": true,
      "lengthMenu": [[50, 100, 500, -1], [50, 100, 500, "All"]]
    });
} );
</script>
{% endblock %}